╔════════════════════════════════════════════════════════════════════════════╗
║                    FORGOT PASSWORD FLOW - COMPLETE                         ║
╚════════════════════════════════════════════════════════════════════════════╝

Step 1: User Requests Password Reset
┌──────────────────────────────────────┐
│   /forgot-password                   │
│                                      │
│   ┌────────────────────────────┐   │
│   │  Enter Email Address       │   │
│   └────────────────────────────┘   │
│            ↓                         │
│   ┌────────────────────────────┐   │
│   │  System Validates:         │   │
│   │  ✓ Email exists            │   │
│   │  ✓ Email is verified       │   │
│   └────────────────────────────┘   │
│            ↓                         │
│   ┌────────────────────────────┐   │
│   │  Send Reset Email          │   │
│   │  with secure link          │   │
│   └────────────────────────────┘   │
└──────────────────────────────────────┘

Step 2: User Clicks Email Link
┌──────────────────────────────────────┐
│   Email Link:                        │
│   /auth/callback?type=recovery       │
│   &code=secure-token                 │
│            ↓                         │
│   ┌────────────────────────────┐   │
│   │  Supabase verifies code    │   │
│   │  Creates recovery session  │   │
│   └────────────────────────────┘   │
│            ↓                         │
│   ┌────────────────────────────┐   │
│   │  Redirect to:              │   │
│   │  /auth/reset-password      │   │
│   └────────────────────────────┘   │
└──────────────────────────────────────┘

Step 3: User Sets New Password
┌──────────────────────────────────────┐
│   /auth/reset-password               │
│                                      │
│   ┌────────────────────────────┐   │
│   │  Validate session exists   │   │
│   └────────────────────────────┘   │
│            ↓                         │
│   ┌────────────────────────────┐   │
│   │  Enter New Password        │   │
│   │  Confirm New Password      │   │
│   └────────────────────────────┘   │
│            ↓                         │
│   ┌────────────────────────────┐   │
│   │  Validate:                 │   │
│   │  ✓ Passwords match         │   │
│   │  ✓ Min 6 characters        │   │
│   └────────────────────────────┘   │
│            ↓                         │
│   ┌────────────────────────────┐   │
│   │  Update password           │   │
│   │  Sign out user             │   │
│   └────────────────────────────┘   │
│            ↓                         │
│   ┌────────────────────────────┐   │
│   │  Redirect to:              │   │
│   │  /login?reset=success      │   │
│   └────────────────────────────┘   │
└──────────────────────────────────────┘

Step 4: User Signs In
┌──────────────────────────────────────┐
│   /login?reset=success               │
│                                      │
│   ┌────────────────────────────┐   │
│   │  ✓ Show success message    │   │
│   │  "Password reset           │   │
│   │   successfully!"           │   │
│   └────────────────────────────┘   │
│            ↓                         │
│   ┌────────────────────────────┐   │
│   │  Enter email & new         │   │
│   │  password                  │   │
│   └────────────────────────────┘   │
│            ↓                         │
│   ┌────────────────────────────┐   │
│   │  Sign in successful        │   │
│   │  Redirect to /feed         │   │
│   └────────────────────────────┘   │
└──────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════

SECURITY FEATURES:
✓ Email must be verified before password reset
✓ Secure token-based authentication
✓ Recovery session validation
✓ Automatic sign-out after password change
✓ Token expires after 1 hour
✓ Email validation in database

VALIDATIONS:
✓ Email exists in system
✓ Email is verified
✓ Passwords match
✓ Password minimum 6 characters
✓ Valid recovery session required

═══════════════════════════════════════════════════════════════════════════
